(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(3486)}])},9054:function(e,n,t){"use strict";var r=t(5152),o=t.n(r)()((function(){return Promise.all([t.e(269),t.e(115)]).then(t.bind(t,4115))}),{loadableGenerated:{webpack:function(){return[4115]}},ssr:!1});n.Z=o},7165:function(e,n,t){"use strict";t.d(n,{FN:function(){return c},Hv:function(){return o},Ls:function(){return r},Wl:function(){return s},oJ:function(){return u},yj:function(){return i},zQ:function(){return a}});var r={A:{color:"#ff0000",councillor:"Denise Ridley"},B:{color:"#ff8800",councillor:"Mira Prinz-Arey"},C:{color:"#ffff00",councillor:"Rich Boggiano"},D:{color:"#00ff00",councillor:"Yousef Saleh"},E:{color:"#0000ff",councillor:"James Solomon"},F:{color:"#ff00ff",councillor:"Frank Gilmore"}},o={"PROTECTED BIKE LANE":{color:"#26de3b"},"PLANNED PROTECTED BIKE LANE":{color:"#b122e0"},"SHARED USE LANE":{color:"#FFFF00"},"SHARED USE PATH":{color:"#00FFFF"}},a={"NEIGHBORHOOD GREENWAY":{color:"lightblue"},"BIKE LANE":{color:"lightorange"},"PROTECTED BIKE LANE":{color:"lightgreen"},"SHARED USE LANE":{color:"lightred"},"SHARED USE PATH":{color:"lightyellow"}},c={openstreetmap:{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:"&copy; <a href=&quot;http://osm.org/copyright&quot;>OpenStreetMap</a> contributors"},alidade_smooth_dark:{url:"https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}{r}.png",attribution:'&copy; <a href="https://stadiamaps.com/">Stadia Maps</a>, &copy; <a href="https://openmaptiles.org/">OpenMapTiles</a> &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors'}},i={wards:"wards.json",roads:"Roads_Jersey_City.json",lur:"light-up-route-20220708.gpx",citibike:"JC_Citi_Bike_Locations.json",HIN:"Vision_Zero_Traffic_Calming_Projects_WFL1/Merged_HIN.json",counties:"County_Boundaries_of_NJ.geojson",county2:"County_Boundaries_of_NJ_2x.geojson",county5:"County_Boundaries_of_NJ_5x.geojson",county10:"County_Boundaries_of_NJ_10x.geojson",bmp:"Proposed Full Network.geojson"},s=[{label:"Bike Lanes",key:"bikeLanes"},{label:"Roads",key:"roads"},{label:"Wards",key:"wards"},{label:"Citi Bike Docks",key:"citibike"},{label:"High Injury Network",key:"HIN"},{label:"Counties",key:"counties"},{label:"Counties/2",key:"county2"},{label:"Counties/5",key:"county5"},{label:"Counties/10",key:"county10"},{label:"Bike Master Plan",key:"bmp"}],u=["wards","counties","county2","county5","county10","roads","HIN","bmp","bikeLanes","citibike"]},3486:function(e,n,t){"use strict";t.r(n),t.d(n,{__N_SSG:function(){return N},default:function(){return L}});var r=t(7568),o=t(1799),a=t(9396),c=t(828),i=t(4051),s=t.n(i),u=t(5893),l=t(9008),d=t.n(l),f=t(6719),p=t.n(f),m=t(6932),h=t(9054),_=t(214),v=t.n(_),g=t(7294),b=t(7165),y=t(1368),k=t(1163),j={lat:40.72,lng:-74.066};var x=b.Wl.filter((function(e){var n=e.key;return["wards","roads","bmp","bikeLanes","citibike"].includes(n)})),E=x.map((function(e){return e.key})),N=!0;function L(e){var n=e.layers,t={l:(0,y.W$)({init:["wards","bikeLanes","citibike"],allValues:E,mapper:{wards:"w",bikeLanes:"b",citibike:"c",bmp:"p",roads:"r"},delim:""}),ll:(0,y.GS)(j,3),z:(0,y.yc)(13)},i=(0,y.O5)({params:t}),l=(0,c.Z)(i.ll,2),f=l[0],_=f.lat,N=f.lng,L=l[1],w=(0,c.Z)(i.z,2),C=w[0],S=w[1],O=(0,c.Z)(i.l,2),P=O[0],Z=O[1],H=Z.add,I=Z.remove,D=(0,g.useMemo)((function(){return Array.from(P).map((function(e){return[b.oJ.indexOf(e),e]})).sort((function(e,n){return(0,c.Z)(e,1)[0]-(0,c.Z)(n,1)[0]})).map((function(e){var n=(0,c.Z)(e,2);n[0];return n[1]}))}),[P]),A=(0,g.useReducer)((function(e,n){var t=(0,c.Z)(n,2),r=t[0],a=t[1];if(r in e)return a[r]?(console.warn("fetchLayers: duplicate add ".concat(r)),e):(console.log("fetchLayers: updating ".concat(r," (").concat(a.length," elems)")),Object.fromEntries(Object.entries(e).map((function(e){var n=(0,c.Z)(e,2),t=n[0],o=n[1];return t===r?[t,a]:[t,o]}))));console.log("fetchLayers: setting ".concat(r,": ").concat(a));var i=(0,o.Z)({},e);return i[r]=a,i}),n),R=A[0],B=A[1];console.log("render: fetchedLayers:",R);var T=(0,g.useMemo)((function(){return Object.fromEntries(D.filter((function(e){return e in R&&R[e]})).map((function(e,n){return[e,n]})))}),[R,D]),M=(0,g.useState)(!1),F=M[0],z=M[1],J=(0,g.useState)(!1),W=J[0],G=J[1],U=window.location.href||void 0,K=null===U||void 0===U?void 0:U.match(y.z1),X=K?K[0]:U,V=(0,g.useMemo)((function(){var e,n=[];return D.includes("bikeLanes")&&n.push(["Protected Bike Lanes"]),D.includes("roads")&&n.push(["Roads"]),D.includes("wards")&&n.push(["Wards"]),D.includes("citibike")&&n.push(["Citi Bike Docks"]),D.includes("bmp")&&n.push(["Bike Master Plan"]),e=0===n.length?null:"JC ".concat(n.join(", ")),console.log(D,e,n),e}),[D]);(0,g.useEffect)((function(){var e=function(){var e=(0,r.Z)(s().mark((function e(n){var t,r,o,a,c,i,u,l,d,f,p;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(U){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:if(!(n in R)){e.next=5;break}return R[n]?console.log("".concat(n,": already fetched")):console.log("".concat(n,": currently fetching")),e.abrupt("return",Promise.resolve());case 5:return B([n,null]),t=b.yj[n],r="".concat(X,"/").concat(t),console.log("fetching layer: ".concat(n,", url: ").concat(r)),e.next=11,fetch(r);case 11:if(o=e.sent,console.log("fetched layer: ".concat(n)),"lur"!==n){e.next=27;break}return e.next=17,o.text();case 17:c=e.sent,i={ignoreAttributes:!1},u=new m.XMLParser(i),l=u.parse(c),d=l.gpx.trk.trkseg.trkpt,f=d.map((function(e){return[parseFloat(e["@_lat"]),parseFloat(e["@_lon"])]})),a=f,console.log("got gpx positions:",f),e.next=32;break;case 27:return e.next=29,o.json();case 29:p=e.sent,a=p.features,console.log("layer ".concat(n,":"),a);case 32:return B([n,a]),H(n),e.abrupt("return",Promise.resolve());case 35:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();Promise.all(D.map(e)).catch(console.error)}),[D]);var Q=(0,k.useRouter)().basePath;return(0,u.jsxs)("div",{className:v().container,children:[(0,u.jsxs)(d(),{children:[(0,u.jsx)("title",{children:V}),(0,u.jsx)("link",{rel:"icon",href:"./favicon.ico"}),(0,u.jsx)("link",{rel:"stylesheet",href:"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"}),(0,u.jsx)("meta",{name:"twitter:card",content:"summary"},"twcard"),(0,u.jsx)("meta",{name:"twitter:creator",content:"RunsAsCoded"},"twhandle"),(0,u.jsx)("meta",{property:"og:url",content:"https://bikejc.github.io/maps"},"ogurl"),(0,u.jsx)("meta",{property:"og:type",content:"website"}),(0,u.jsx)("meta",{property:"og:image",content:"https://bikejc.github.io/maps/1-pbls.png"},"ogimage"),(0,u.jsx)("meta",{property:"og:site_name",content:"JC Bike Lane Map"},"ogsitename"),(0,u.jsx)("meta",{property:"og:title",content:"JC Bike Lane + Ward Map"},"ogtitle"),(0,u.jsx)("meta",{property:"og:description",content:"\u224810 protected bike lanes overlaid on the 6 council wards"},"ogdesc")]}),(0,u.jsx)("main",{className:v().main,children:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(h.Z,{className:v().homeMap,center:{lat:_,lng:N},zoom:C,zoomControl:!1,zoomSnap:.5,zoomDelta:.5,children:function(e){return function(e){var n=e.useMapEvents,t=e.TileLayer,r=(e.Marker,e.Circle),o=e.Polygon,a=e.Polyline,i=(e.ZoomControl,e.Popup,e.Tooltip),s=e.activeLayerIndices,l=e.fetchedLayers,d=e.activeLayers,f=e.setLL,p=e.setZoom,m=n({move:function(){return f(m.getCenter(),"replaceIn")},zoom:function(){return p(m.getZoom(),"replaceIn")}}),h=b.FN.alidade_smooth_dark,_=h.url,v=h.attribution;return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(t,{url:_,attribution:v}),"wards"in l&&d.includes("wards")&&function(){var e,n=s.wards;return null===(e=l.wards)||void 0===e?void 0:e.map((function(e){var t=e.attributes,r=e.geometry,a=t.NAME,s=b.Ls[a],l=s.color,d=s.councillor,f="ward-".concat(a,"_rank").concat(n);return r.rings.map((function(e){return e=e.map((function(e){var n=(0,c.Z)(e,2),t=n[0];return[n[1],t]})),(0,u.jsx)(o,{style:{zIndex:1},weight:1,color:"black",fillColor:l,positions:e,fillOpacity:.2,children:(0,u.jsxs)(i,{sticky:!0,children:[(0,u.jsxs)("span",{children:["Ward ",a,":"]})," ",(0,u.jsx)("span",{children:d})]})},f)}))}))}(),"roads"in l&&d.includes("roads")&&function(){var e,n=s.roads;return null===(e=l.roads)||void 0===e?void 0:e.map((function(e){var t=e.attributes,r=e.geometry,o=t.OBJECTID,s=t.LocalName,l=t.DIRECTION,d=t.MEASURED_L,f="".concat(s,": ").concat(d,"mi");return(l=l.trim())&&(f="".concat(f,", ").concat(l)),r.paths.map((function(e,t){var r="".concat(s,"_").concat(o,"_").concat(t,"_rank").concat(n);return e=e.map((function(e){var n=(0,c.Z)(e,2),t=n[0];return[n[1],t]})),(0,u.jsx)(a,{color:"red",positions:e,children:(0,u.jsx)(i,{sticky:!0,children:f})},r)}))}))}(),"bikeLanes"in l&&d.includes("bikeLanes")&&function(){var e,n=s.bikeLanes;return null===(e=l.bikeLanes)||void 0===e?void 0:e.map((function(e){var t,r=e.attributes,o=e.geometry,s=r.OBJECTID,l=r.Street_Name,d=r.Type,f=r.Status;l=l||r.StreetName;var p="PLANNED"===f?"PLANNED ".concat(d):d;if("PROTECTED BIKE LANE"===p||"PLANNED PROTECTED BIKE LANE"===p){var m=(null===(t=b.Hv[null===p||void 0===p?void 0:p.trim()])||void 0===t?void 0:t.color)||"black";return o.paths.map((function(e,t){e=e.map((function(e){var n=(0,c.Z)(e,2),t=n[0];return[n[1],t]}));var r="".concat(s,"_").concat(t,"_rank").concat(n);return(0,u.jsx)(a,{color:m,positions:e,children:(0,u.jsxs)(i,{sticky:!0,children:[l,", ",p]})},r)}))}}))}(),"citibike"in l&&d.includes("citibike")&&function(){var e,n=s.citibike;return null===(e=l.citibike)||void 0===e?void 0:e.map((function(e){var t=e.attributes,o=e.geometry,a=t.OBJECTID,c=t.Location,s=t.StationID,l=[o.y,o.x],d="".concat(a,"_rank").concat(n);return(0,u.jsx)(r,{center:l,color:"orange",radius:15,children:(0,u.jsxs)(i,{sticky:!0,children:[c," (",s,")"]})},d)}))}(),"bmp"in l&&d.includes("bmp")&&function(){var e,n=s.bmp;return null===(e=l.bmp)||void 0===e?void 0:e.map((function(e,t){var r,o=e.properties,s=e.geometry,l=o.Street,d=o.Type,f=o.Direction,p=o.Lane_count,m=(null===(r=b.zQ[null===d||void 0===d?void 0:d.trim()])||void 0===r?void 0:r.color)||"black";if("LineString"===s.type){var h=s.coordinates.map((function(e){var n=(0,c.Z)(e,2),t=n[0];return[n[1],t]})),_="".concat(l,"_").concat(t,"_rank").concat(n);return(0,u.jsx)(a,{color:m,positions:h,children:(0,u.jsxs)(i,{sticky:!0,children:[l," (",d,", ",f,"/b",p&&", ".concat(p," lanes"),")"]})},_)}console.warn("Street ".concat(l,", geometry type ").concat(s.type))}))}(),"HIN"in l&&d.includes("HIN")&&function(){var e,n=s.HIN;return null===(e=l.HIN)||void 0===e?void 0:e.map((function(e){return e.geometry.paths.map((function(e,t){return(0,u.jsx)(a,{positions:e.map((function(e){var n=(0,c.Z)(e,2),t=n[0];return[n[1],t]})),color:"orange"},"HIN_".concat(t,"_rank").concat(n))}))}))}(),"lur"in l&&d.includes("lur")&&function(){var e=l.lur;return e&&(0,u.jsx)(a,{color:"red",positions:e},"lur")}()]})}((0,a.Z)((0,o.Z)({},e),{activeLayerIndices:T,fetchedLayers:R,activeLayers:D,setLL:L,setZoom:S}))}}),(0,u.jsx)("div",{className:v().title,children:V}),(0,u.jsx)("div",{className:p().gearContainer,onMouseEnter:function(){return G(!0)},onMouseLeave:function(){return G(!1)},children:(0,u.jsxs)("div",{className:p().settings,children:[(0,u.jsx)("i",{className:"fa fa-gear ".concat(p().gear),onClick:function(){return z(!F)}}),(F||W)&&(0,u.jsxs)("div",{className:p().menu,children:[(0,u.jsx)("ul",{className:p().layers,children:x.map((function(e){var n=e.label,t=e.key,r=D.includes(t);return(0,u.jsx)("li",{children:(0,u.jsxs)("label",{children:[(0,u.jsx)("input",{type:"checkbox",onChange:function(e){var n=e.target.checked;n===r&&console.error("layer ".concat(t,": checked ").concat(n," != active ").concat(r)),n?H(t):I(t)},checked:r}),n]})},t)}))}),(0,u.jsxs)("div",{className:p().icons,children:[(0,u.jsx)("a",{href:"https://github.com/bikejc/maps",children:(0,u.jsx)("img",{alt:"GitHub logo",className:p().icon,src:"".concat(Q,"/gh.png")})}),(0,u.jsx)("a",{href:"https://bikejc.org",children:(0,u.jsx)("img",{alt:"Bike JC logo",className:p().icon,src:"".concat(Q,"/logo.png")})})]})]})]})})]})})]})}},1368:function(e,n,t){"use strict";t.d(n,{GS:function(){return u},O5:function(){return f},W$:function(){return d},yc:function(){return l},z1:function(){return s}});var r=t(828),o=t(9815),a=t(1163),c=t(7294),i=t(3912),s=RegExp("[^?#]+","u");function u(e,n){return{encode:function(t){var r=t.lat,o=t.lng;return r===e.lat&&o===e.lng?void 0:n?"".concat(r.toFixed(n),"_").concat(o.toFixed(n)):"".concat(r,"_").concat(o)},decode:function(n){if(!n)return e;var t=(0,r.Z)(n.split("_").map(parseFloat),2);return{lat:t[0],lng:t[1]}}}}function l(e){return{encode:function(n){return n===e?void 0:n.toString()},decode:function(n){return n?parseFloat(n):e}}}function d(e){var n,t=e.init,o=e.allValues,a=e.mapper,c=e.delim,s=function(e){return Array.from(e).filter((function(e){return!!o.includes(e)||(console.warn("Invalid value: ".concat(value," not in ").concat(o)),!1)}))};c="undefined"===typeof c?"_":c,a&&(n=Object.fromEntries(Object.entries(a).map((function(e){var n=(0,r.Z)(e,2),t=n[0];return[n[1],t]}))));var u=function(e){return e=s(e),a&&(e=e.map((function(e){return a[e]}))),e.join(c)},l=u(t);return{encode:function(e){var n=u(e);if(n!==l)return n},decode:function(e){if(!e&&""!==e)return t;var r=e.split(c);return n&&(r=r.filter((function(e){return e in n||(console.warn("Unrecognized value: ".concat(e," not in ").concat(Object.keys(n).join(","))),!1)})).map((function(e){return n[e]}))),r=s(r)},use:i.$}}function f(e){var n=e.params,t=(0,a.useRouter)(),i=t.asPath.replace(s,""),u=Object.fromEntries(new URLSearchParams(i).entries()),l=Object.fromEntries(Object.entries(n).map((function(e){var n=(0,r.Z)(e,2),t=n[0],o=n[1],a=(0,r.Z)((o.use||c.useState)(o.decode(u[t])),2);return[t,{val:a[0],set:a[1],param:o}]}))),d=Object.values(l).map((function(e){return e.val})),f=t.asPath.match(s),p=f?f[0]:t.asPath;return(0,c.useEffect)((function(){var e={};Object.entries(l).map((function(n){var t=(0,r.Z)(n,2),o=t[0],a=t[1],c=a.val,i=a.param.encode(c);void 0!==i&&(e[o]=i)}));var n=new URLSearchParams(e).toString();t.replace({pathname:t.pathname,hash:"",search:n},{pathname:p,hash:"",search:n},{shallow:!0,scroll:!1})}),(0,o.Z)(d).concat([p])),Object.fromEntries(Object.entries(l).map((function(e){var n=(0,r.Z)(e,2),t=n[0],o=n[1];return[t,[o.val,o.set]]})))}},3912:function(e,n,t){"use strict";t.d(n,{$:function(){return a}});var r=t(9815),o=t(7294),a=function(e){var n=(0,o.useState)(new Set(e)),t=n[0],a=n[1];return[t,(0,o.useMemo)((function(){return{add:function(e){return a((function(n){return console.log("prevSet:",n),new Set((0,r.Z)(n).concat([e]))}))},remove:function(e){return a((function(n){return new Set((0,r.Z)(n).filter((function(n){return n!==e})))}))},clear:function(){return a(new Set)}}}),[a])]}},214:function(e){e.exports={container:"Home_container__bCOhY",main:"Home_main__nLjiQ",footer:"Home_footer____T7K",title:"Home_title__T09hD",description:"Home_description__41Owk",code:"Home_code__suPER",grid:"Home_grid__GxQ85",card:"Home_card___LpL1",logo:"Home_logo__27_tb",homeMap:"Home_homeMap__ZgfiY"}},6719:function(e){e.exports={gearContainer:"index_gearContainer__hRNDa",gear:"index_gear__jl7gj",settings:"index_settings__hL9ax",menu:"index_menu__vXSVq",layers:"index_layers__Vs_35",icons:"index_icons__4oXXp",icon:"index_icon__IdCia"}}},function(e){e.O(0,[160,932,774,888,179],(function(){return n=5557,e(e.s=n);var n}));var n=e.O();_N_E=n}]);