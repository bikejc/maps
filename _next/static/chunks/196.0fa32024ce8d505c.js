(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[196],{3196:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return S}});var r=n(5893),l=n(7294),i=n(5243),o=n.n(i),u=n(7104),c=n.n(u),a={src:"/_next/static/media/marker-icon-2x.93fdb12c.png",height:82,width:50,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAICAYAAAAx8TU7AAAAoUlEQVR42mNwq5rH7zb5+FLdiadfuU4+vty9ZqEAg2P/0R1+M87/b1xz+b8/kAbydzIwthz7373+yt//////m7Dx6l+G5mP/GfSbD17xmXD2/8wtV377A2k9IJ/BunZDglrjif8MpSd/qTac+G9TuyGWAQQMavcd1607/d+wdt8xBhjQL13nplF58D+QdoUL6iQUMesXr2jQSShkZmBgYAAAnntNXpTByKMAAAAASUVORK5CYII=",blurWidth:5,blurHeight:8},s={src:"/_next/static/media/marker-icon.d577052a.png",height:41,width:25,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAICAYAAAAx8TU7AAAAoUlEQVR42mNwK5vB4zr5+EL9iadfAulFbhVzeBkc+45u8Jtx/n/Dmiv//YE0kL+JgbPl2N/2tZf//f///2/X+iv/GFuO/mUwaD54ybv/zP/pmy//9p1w5r9+88GLDFa1GxLUGk/8Zyg9+Uut4cR/q5oNcQwgYFCz97hu3Zn/IJoBBvRL17lrVB78r1+61g0uqJvcyKJfvLxJN6mKhYGBgQEAd2dNMQ5zpzwAAAAASUVORK5CYII=",blurWidth:5,blurHeight:8},d={src:"/_next/static/media/marker-shadow.612e3b52.png",height:41,width:41,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAQAAABuBnYAAAAASElEQVR42o3BsQmAMAAAsLRYinSWbkJXL7C46+QgOHiB/5/gCyZ+CgZZEgUgmTWTYgCaXbeoMmSXx6mrEkS316EZBQJWmyLCB7UNBGZ+qNRZAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},f=n(4661);function p(t,e){return Object.freeze({...t,...e})}let A=(0,l.createContext)(null),m=A.Provider;function v(){let t=(0,l.useContext)(A);if(null==t)throw Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return t}var h=n(3935);function b(t,e,n){return Object.freeze({instance:t,context:e,container:n})}function g(t,e){return null==e?function(e,n){let r=(0,l.useRef)();return r.current||(r.current=t(e,n)),r}:function(n,r){let i=(0,l.useRef)();i.current||(i.current=t(n,r));let o=(0,l.useRef)(n),{instance:u}=i.current;return(0,l.useEffect)(function(){o.current!==n&&(e(u,n,o.current),o.current=n)},[u,n,r]),i}}function y(t,e){let n=(0,l.useRef)(e);(0,l.useEffect)(function(){e!==n.current&&null!=t.attributionControl&&(null!=n.current&&t.attributionControl.removeAttribution(n.current),null!=e&&t.attributionControl.addAttribution(e)),n.current=e},[t,e])}function E(t,e){let n=(0,l.useRef)();(0,l.useEffect)(function(){return null!=e&&t.instance.on(e),n.current=e,function(){null!=n.current&&t.instance.off(n.current),n.current=null}},[t,e])}function L(t,e){let n=t.pane??e.pane;return n?{...t,pane:n}:t}function w(t,e){(0,l.useEffect)(function(){let n=e.layerContainer??e.map;return n.addLayer(t.instance),function(){e.layerContainer?.removeLayer(t.instance),e.map.removeLayer(t.instance)}},[e,t])}function x(t,e){var n;let r=g(t,e);return n=function(t){let e=v(),n=r(L(t,e),e);return E(n.current,t.eventHandlers),w(n.current,e),function(t,e){let n=(0,l.useRef)();(0,l.useEffect)(function(){if(e.pathOptions!==n.current){let r=e.pathOptions??{};t.instance.setStyle(r),n.current=r}},[t,e])}(n.current,t),n},(0,l.forwardRef)(function(t,e){let{instance:r,context:i}=n(t).current;return(0,l.useImperativeHandle)(e,()=>r),null==t.children?null:l.createElement(m,{value:i},t.children)})}let k=x(function({positions:t,...e},n){let r=new i.Polygon(t,e);return b(r,p(n,{overlayContainer:r}))},function(t,e,n){e.positions!==n.positions&&t.setLatLngs(e.positions)}),C=function(t,e){var n;let r=g(t);return n=function(t,n){let l=v(),i=r(L(t,l),l);return y(l.map,t.attribution),E(i.current,t.eventHandlers),e(i.current,l,t,n),i},(0,l.forwardRef)(function(t,e){let[r,i]=(0,l.useState)(!1),{instance:o}=n(t,i).current;(0,l.useImperativeHandle)(e,()=>o),(0,l.useEffect)(function(){r&&o.update()},[o,r,t.children]);let u=o._contentNode;return u?(0,h.createPortal)(t.children,u):null})}(function(t,e){let n=new i.Tooltip(t,e.overlayContainer);return b(n,e)},function(t,e,{position:n},r){(0,l.useEffect)(function(){let l=e.overlayContainer;if(null==l)return;let{instance:i}=t,o=t=>{t.tooltip===i&&(null!=n&&i.setLatLng(n),i.update(),r(!0))},u=t=>{t.tooltip===i&&r(!1)};return l.on({tooltipopen:o,tooltipclose:u}),l.bindTooltip(i),function(){l.off({tooltipopen:o,tooltipclose:u}),null!=l._map&&l.unbindTooltip()}},[t,e,r,n])}),N=x(function({positions:t,...e},n){let r=new i.Polyline(t,e);return b(r,p(n,{overlayContainer:r}))},function(t,e,n){e.positions!==n.positions&&t.setLatLngs(e.positions)}),R=x(function({center:t,children:e,...n},r){let l=new i.Circle(t,n);return b(l,p(r,{overlayContainer:l}))},function(t,e,n){e.center!==n.center&&t.setLatLng(e.center),null!=e.radius&&e.radius!==n.radius&&t.setRadius(e.radius)}),I=function(t,e){var n;let r=g(t,e);return n=function(t){let e=v(),n=r(L(t,e),e);return y(e.map,t.attribution),E(n.current,t.eventHandlers),w(n.current,e),n},(0,l.forwardRef)(function(t,e){let{instance:r}=n(t).current;return(0,l.useImperativeHandle)(e,()=>r),null})}(function({url:t,...e},n){let r=new i.TileLayer(t,L(e,n));return b(r,n)},function(t,e,n){!function(t,e,n){let{opacity:r,zIndex:l}=e;null!=r&&r!==n.opacity&&t.setOpacity(r),null!=l&&l!==n.zIndex&&t.setZIndex(l)}(t,e,n);let{url:r}=e;null!=r&&r!==n.url&&t.setUrl(r)});function U(){return(U=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}let _=(0,l.forwardRef)(function({bounds:t,boundsOptions:e,center:n,children:r,className:o,id:u,placeholder:c,style:a,whenReady:s,zoom:d,...f},p){let[A]=(0,l.useState)({className:o,id:u,style:a}),[v,h]=(0,l.useState)(null);(0,l.useImperativeHandle)(p,()=>v?.map??null,[v]);let b=(0,l.useCallback)(r=>{if(null!==r&&null===v){let l=new i.Map(r,f);null!=n&&null!=d?l.setView(n,d):null!=t&&l.fitBounds(t,e),null!=s&&l.whenReady(s),h(Object.freeze({__version:1,map:l}))}},[]);(0,l.useEffect)(()=>()=>{v?.map.remove()},[v]);let g=v?l.createElement(m,{value:v},r):c??null;return l.createElement("div",U({},A,{ref:b}),g)});function j(t){let{activeLayerIndices:e,fetchedLayers:n,activeLayers:i,setLL:o,setZoom:u}=t,c=function(t){let e=v().map;return(0,l.useEffect)(function(){return e.on(t),function(){e.off(t)}},[e,t]),e}({move:()=>o(c.getCenter(),"replaceIn"),zoom:()=>u(c.getZoom(),"replaceIn")}),{url:a,attribution:s}=f.FN.alidade_smooth_dark;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(I,{url:a,attribution:s}),"wards"in n&&i.includes("wards")&&(()=>{var t;let l=e.wards;return null===(t=n.wards)||void 0===t?void 0:t.map(t=>{let{attributes:e,geometry:n}=t,i=e.NAME,o=f.Ls[i],u=o.color,c=o.councillor,a="ward-".concat(i,"_rank").concat(l);return n.rings.map(t=>(t=t.map(t=>{let[e,n]=t;return[n,e]}),(0,r.jsx)(k,{style:{zIndex:1},weight:1,color:"black",fillColor:u,positions:t,fillOpacity:.2,children:(0,r.jsxs)(C,{sticky:!0,children:[(0,r.jsxs)("span",{children:["Ward ",i,":"]})," ",(0,r.jsx)("span",{children:c})]})},a)))})})(),"roads"in n&&i.includes("roads")&&(()=>{var t;let l=e.roads;return null===(t=n.roads)||void 0===t?void 0:t.map(t=>{let{attributes:e,geometry:n}=t,{OBJECTID:i,LocalName:o,DIRECTION:u,MEASURED_L:c}=e,a="".concat(o,": ").concat(c,"mi");return(u=u.trim())&&(a="".concat(a,", ").concat(u)),n.paths.map((t,e)=>{let n="".concat(o,"_").concat(i,"_").concat(e,"_rank").concat(l);return t=t.map(t=>{let[e,n]=t;return[n,e]}),(0,r.jsx)(N,{color:"red",positions:t,children:(0,r.jsx)(C,{sticky:!0,children:a})},n)})})})(),"bikeLanes"in n&&i.includes("bikeLanes")&&(()=>{var t;let l=e.bikeLanes;return null===(t=n.bikeLanes)||void 0===t?void 0:t.map(t=>{var e;let{attributes:n,geometry:i}=t,{OBJECTID:o,Street_Name:u,Type:c,Status:a}=n;if("TABLED"===a)return;u=u||n.StreetName;let s="PLANNED"===a?"PLANNED ".concat(c):c;if("PROTECTED BIKE LANE"!==s&&"PLANNED PROTECTED BIKE LANE"!==s)return;let d=(null===(e=f.Hv[null==s?void 0:s.trim()])||void 0===e?void 0:e.color)||"black";return i.paths.map((t,e)=>{t=t.map(t=>{let[e,n]=t;return[n,e]});let n="".concat(o,"_").concat(e,"_rank").concat(l);return(0,r.jsx)(N,{color:d,positions:t,children:(0,r.jsxs)(C,{sticky:!0,children:[u,", ",s]})},n)})})})(),"citibike"in n&&i.includes("citibike")&&(()=>{var t;let l=e.citibike;return null===(t=n.citibike)||void 0===t?void 0:t.map(t=>{let{attributes:e,geometry:n}=t,{OBJECTID:i,Location:o,StationID:u}=e,c=[n.y,n.x],a="".concat(i,"_rank").concat(l);return(0,r.jsx)(R,{center:c,color:"lightblue",radius:10,opacity:1,weight:10,fill:!0,fillColor:"lightblue",fillOpacity:1,children:(0,r.jsxs)(C,{sticky:!0,children:[o," (",u,")"]})},a)})})(),"bmp"in n&&i.includes("bmp")&&(()=>{var t;let l=e.bmp;return null===(t=n.bmp)||void 0===t?void 0:t.map((t,e)=>{var n;let{properties:i,geometry:o}=t,{Street:u,Type:c,Direction:a,Lane_count:s}=i,d=(null===(n=f.zQ[null==c?void 0:c.trim()])||void 0===n?void 0:n.color)||"black";if("LineString"!==o.type){console.warn("Street ".concat(u,", geometry type ").concat(o.type));return}let p=o.coordinates.map(t=>{let[e,n]=t;return[n,e]}),A="".concat(u,"_").concat(e,"_rank").concat(l);return(0,r.jsx)(N,{color:d,positions:p,children:(0,r.jsxs)(C,{sticky:!0,children:[u," (",c,", ",a,"/b",s&&", ".concat(s," lanes"),")"]})},A)})})(),"HIN"in n&&i.includes("HIN")&&(()=>{var t;let l=e.HIN;return null===(t=n.HIN)||void 0===t?void 0:t.map(t=>{let{geometry:e}=t;return e.paths.map((t,e)=>(0,r.jsx)(N,{positions:t.map(t=>{let[e,n]=t;return[n,e]}),color:"orange"},"HIN_".concat(e,"_rank").concat(l)))})})(),"lur"in n&&i.includes("lur")&&(()=>{let t=n.lur;return t&&(0,r.jsx)(N,{color:"red",positions:t},"lur")})()]})}let B=t=>{let{className:e,activeLayerIndices:n,fetchedLayers:i,activeLayers:u,setLL:f,setZoom:p,...A}=t,m=c().map;return e&&(m="".concat(m," ").concat(e)),(0,l.useEffect)(()=>{!async function(){delete o().Icon.Default.prototype._getIconUrl,o().Icon.Default.mergeOptions({iconRetinaUrl:a.src,iconUrl:s.src,shadowUrl:d.src})}()},[]),(0,r.jsx)(_,{className:m,...A,children:(0,r.jsx)(j,{activeLayerIndices:n,fetchedLayers:i,activeLayers:u,setLL:f,setZoom:p})})};var S=B},7104:function(t){t.exports={map:"Map_map__9eK65"}}}]);